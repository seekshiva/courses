<script type="text/template" id="login-template">
  <div class="container">
    <form action="/authenticate" method="post" role="form" class="col-md-3 form-signin" style="text-align: center; ">
      <h2 class="form-signin-heading">Sign In</H2>
      <% unless flash[:notice].nil? %>
        <div class="alert <%= flash[:notice_type] %>">
          <%= flash[:notice] %>
        </div>
      <% end %>
      <div class="form-group">
        <div class="input-group">
          <input type="text" name="username" style="text-align: right;" class="form-control" placeholder="webmail id" autofocus autocomplete="off">
          <input type="hidden" name="redirect_url" value="{{url}}">
          <span class="input-group-addon">@nitt.edu</span>
        </div>
        <input type="password" name="password" class="form-control" placeholder="password" style="text-align: center; ">
      </div>
      <%= token_tag %>
      <button type="submit" class="btn btn-lg btn-primary btn-block">Sign In</button>
    </form>
  </div>
</script>
  
<script type="text/template" id="departments-template">
  <div class="s-push"></div>
  <div class="panel panel-default">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Department</th>
          <th>HOD</th>
        </tr>
      </thead>
      <tbody>
        {{#each depts}}
          <tr>
            <td>
              <a href="/departments/{{this.short}}">{{this.name}}</a>
            </td>
            <td>
              {{#if this.hod_email}}
                <a href="/profile/{{this.hod_email}}">{{this.hod}}</a>
              {{else}}
                -
              {{/if}}
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</script>

<script type="text/template" id="usermenu-template">
  <li role="presentation" class="dropdown-header"><strong>My Courses</strong></li>
  {{#if attending}}
    {{#each subs}}
      {{#if this.current}}
        <li role="presentation"><a href="/terms/{{this.term_id}}">{{this.course_name}}</a></li>
      {{/if}}
    {{/each}}
  {{else}}
    <li role="presentation"><a href="#"><nobr>Sorry you don&#39;t seem </nobr><br><nobr>to be attending any</nobr><br><nobr> current course</nobr></a></li>
  {{/if}}
  <li role="presentation" class="divider"></li>
  {{#if user.admin}}
    <li role="presentation"><a class="external" href="/admin">Admin panel</a></li>
  {{/if}}
  <li role="presentation"><a href="/profile/me">My Profile</a></li>
  <li role="presentation"><a class="external" href="/signout">Sign out</a></li>
</script>

<script type="text/template" id="department-template">
  <h3 style="font-weight: 400; ">
    <a href="/departments" class="btn btn-default btn-sm" title="Department List">
      <i class="glyphicon glyphicon-chevron-left"></i>
    </a>
    <small>{{dept.short}}</small>
    {{dept.name}}
  </h3>
  <div>
    Headed by <strong>{{#if dept.hod_email}}<a href="/profile/{{dept.hod_email}}">{{dept.hod}}</a>{{else}}-{{/if}}</strong>
  </div>
  <div class="s-push"></div>

  <table class="table table-hover">
    <caption>
      <h3>Courses Offered</h3>
    </caption>
    <thead>
      <tr>
        <th>Course</th>
        <th>Course Instructor</th>
        <th># credits</th>
      </tr>
    </thead>
    <tbody>
      {{#if dept.course_listing}}
        {{#each dept.course_listing}}
          <tr><th colspan="3">{{this.semester}}</th></tr>
          {{#each this.course_list}}
            <tr>
              <td>
                <a href="/terms/{{this.term_id}}">
                  {{this.code}} - {{this.name}}
                </a>
              </td>
              <td>
                <small>
                  {{#each this.instructors}}
                    <div><a href="/profile/{{this.email}}">{{this.name}}</a></div>
                  {{/each}}
                </small>
              </td>
              <td>{{this.credits}}</td>
            </tr>
          {{/each}}
        {{/each}}
      {{else}}
        <tr><td>No course is being offered by this department this year.</td></tr>
      {{/if}}
    </tbody>
  </table>
</script>


<script type="text/template" id="course-template">
  <h3>
    <small>{{course.code}}</small>
    {{course.name}}
  </h3>

  <ul class="nav nav-tabs local" id="specialized_view_selector">
    <li class="span2">
      <span class="nav_container">
        <strong class="label label-default">{{course.credits}} credits</strong>
      </span>
    </li>
    <li id="view_course_info"><a href="/courses/{{course.id}}/info">Info</a></li>
    <li id="view_course_topics"><a href="/courses/{{course.id}}/topics">Topics</a></li>
    <li id="view_course_reference"><a href="/courses/{{course.id}}/reference">
        Reference Material
        <small class="badge">{{course.reference_books.length}}</small>
      </a>
    </li>
  </ul>
  <div id="specialized_view"></div>
</script>


<script type="text/template" id="course-info-template">
  <div>
    <h4>Overview</h4>
    <table class="table bottom_line">
      <tr>
        <td colspan="2">
          {{{course.about}}}
        </td>
      </tr>
      <tr>
        <th>
          <strong>Departments Offered</strong>
        </th>
        <td>
          {{#each course.departments}}
            {{this.name}}
          {{/each}}
        </td>
      </tr>
    </table>
  </div>
</script>

<script type="text/template" id="course-topics-template">
  {{#if course.sections}}
    <div class="row">
      <ul class="nav nav-pills nav-stacked local-nav col-md-3">
        <li class="{{#unless course_sections}}active{{/unless}}"><a href="#_all_sections" data-toggle="tab">All</a></li>
        {{#each course.sections}}
          <li class="{{#if this.active}}active{{/if}}">
            <a href="#_section_{{this.id}}" data-toggle="tab">
              <div class="badge pull-right">{{this.topics.length}}</div>
              {{this.short_title}}
            </a>
          </li>
        {{/each}}
      </ul>
      <div class="tab-content col-md-9">
        <div class="tab-pane active _topic_list" id="_all_sections">
          <table class="table bottom_line">
            <tbody>
              {{#each course.sections}}
                {{#each this.topics}}
                  <tr>
                    <td>
                      <dl>
                        <dt>
                          {{this.title}}
                        </dt>
                        <dd>
                          <p>{{{toMarkdown this.description}}}</p>
                          <table class="table table-bordered">
                            <thead>
                              <tr>
                                {{#each this.reference}}
                                  <th><small>{{this.book}}</small></th>
                                {{/each}}
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                {{#each this.reference}}
                                  <td><small>{{this.indices}}</small></td>
                                {{/each}}
                              </tr>
                            </tbody>
                          </table>
                        </dd>
                      </dl>
                    </td>
                  </tr>
                {{/each}}
              {{/each}}
            </tbody>
          </table>
        </div>


        {{#each course.sections}}
          <div class="tab-pane _topic_list" id="_section_{{this.id}}">
            <table class="table bottom_line">
              <tbody>
                <tr><td>
                  <h4>{{this.title}}</h4>
                </td></tr>
                {{#unless this.topics}}
                  <tr><td>
                    No topics found under this section
                  </td></tr>
                {{/unless}}
                {{#each this.topics}}
                  <tr><td>
                    <dl>
                      <dt>{{this.title}}</dt>
                      <dd>
                        <p><small>
                          {{#if this.classes}}
                            This topic was taught on
                            {{#each this.classes}}
                              {{this.date}}
                            {{/each}}
                          {{else}}
                            This topic has not been taught so far this semester
                          {{/if}}
                        </small></p>
                        <p>{{{toMarkdown this.description}}}</p>
                        <table class="table table-bordered">
                          <thead><tr>
                            {{#each this.reference}}
                              <th><small>{{this.book}}</small></th>
                            {{/each}}
                          </tr></thead>
                          <tbody><tr>
                            {{#each this.reference}}
                              <td><small>{{this.indices}}</small></td>
                            {{/each}} 
                          </tr></tbody>
                        </table>
                      </dd>
                    </dl>
                  </td></tr>
                {{/each}}
              </tbody>
            </table>
          </div>
        {{/each}}
      </div>
    </div>
  {{else}}
    <table class="table bottom_line">
      <tbody>
        <tr><td style="padding: 20px;">
          No topic found for this course.
        </td></tr>
      </tbody>
    </table>
  {{/if}}
</script>

<script type="text/template" id="course-reference-template">
  {{#unless course.reference_books}}
  
    <table class="table bottom_line">
      <tbody><tr><td style="padding: 20px;">
        No Reference material found for this subject.
      </td></tr></tbody>
    </table>

  {{else}}

    <div class="row">
      <ul class="nav nav-pills nav-stacked col-md-3 local-nav">
        <li class="active"><a href="#_reference_books" data-toggle="tab">Books</a></li>
      </ul>
      <div class="tab-content col-md-9">
        <div class="tab-pane active _reference_list" id="_reference_books">
          <table class="table bottom_line">
            <tbody>
              {{#each course.reference_books}}
                <tr><td style="padding-right: 20px;">
                  <h4>{{this.title}} <small>({{this.year}})</small></h4>
                  <table class="table table-striped table-condensed">
                    <tbody>
                      <tr><th width="30%">Authors</th><td>
                        <ul style="padding-left: 15px;">
                          {{#each this.authors}}
                            <li>{{this.name}}</li>
                          {{/each}}
                        </ul>
                      </td></tr>
                      <tr><th>Publisher</th><td>{{this.publisher}}/</td></tr>
                      <tr><th>Edition</th><td>{{this.edition}}</td></tr>
                      <tr><th>ISBN</th><td>{{this.isbn}}</td></tr>
                    </tbody>
                  </table>
                </td></tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>

  {{/unless}}
</script>


<script type="text/template" id="term-template">
  <h3>
    {{#if term.faculty}}
      <button data-target="#TermSubModal" role="button" class="btn btn-success btn-sm" data-toggle="modal">
        <i class="glyphicon glyphicon-list"></i>
      </button>
      <div class="modal fade" id="TermSubModal" tabindex="-1" role="dialog" aria-hidden="true">    
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close pull-right" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h3>List of Students attending this course</h3>
            </div>
            <div class="modal-body">
              <div style="height:350px;overflow:auto;">
                <ul class="list-group">
                  {{#if term.sub_list.length}}
                    {{#each term.sub_list}}
                      <li class="list-group-item"><a href="/profile/{{this.email}}">{{this.name}}</a></li>
                    {{/each}}
                  {{else}}
                    <li>Sorry, no one seems to be subscribed to this course</li>
                  {{/if}}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    {{/if}}

    <small>{{term.course.code}}</small>
    {{term.course.name}}
  </h3>
  {{#if term.instructors}}
    <p>
      <strong>Course Instructor:</strong>
      {{#each term.instructors}}
      <span><a href="/profile/{{this.email}}">{{this.instructor}}</a></span>
      {{/each}}
    </p>
  {{/if}}

  <ul class="nav nav-tabs local" id="specialized_view_selector">
    <li id="view_term_info"><a href="/terms/{{term.id}}/info">Info</a></li>
    <li id="view_term_topics"><a href="/terms/{{term.id}}/topics">Topics</a></li>
    <!-- <li id="view_term_classes"><a href="/terms/{{term.id}}/classes">Classes</a></li> -->
    <li id="view_term_reference"><a href="/terms/{{term.id}}/reference">
      Reference Material
      <small class="badge">{{term.course.reference_books.length}}{{#if term.attachments.length}} + {{term.attachments.length}}{{/if}}</small>
    </a></li>
  </ul>
  <div id="specialized_view"></div>
</script>

<script type="text/template" id="term-subscription-template">
  <th>
    Attending this term :
  </th>
  <td>
    <div class="field">
      <input  type="checkbox" {{#if subscribed}}checked{{/if}} id="{{term_id}}_subscription_status" class="make-switch switch-small" data-on="success" data-off="warning" data-on-label="YES" data-off-label="NO">
    </div>
  </td>
</script>

<script type="text/template" id="term-info-template">
  <div class="row" id="term-info-page">
    <div class="list-group local-nav col-md-3">
      <a class="list-group-item {{#if tab.overview}}active{{/if}}" href="#overview" data-toggle="tab">Overview</a>
      <a class="list-group-item {{#if tab.instructor}}active{{/if}}" href="#instructor" data-toggle="tab">Instructor</a>
      <a class="list-group-item {{#if tab.outline}}active{{/if}}" href="#outline" data-toggle="tab">Outline</a>
    </div>
    <div class="tab-content col-md-9">
      <div class="tab-pane {{#if tab.overview}}active{{/if}}" id="overview">
        <table class="table bottom_line">
          <tr>
            <td colspan="2">
              {{{term.course.about}}}
            </td>
          </tr>
          <tr><th>
              <strong>Course Instructor</strong>
            </th>
            <td>
              {{#each term.instructors}}
              <a href="/profile/{{this.email}}">{{this.instructor}}</a>
              {{/each}}
          </td></tr>
          <tr><th>
              <strong>Workload</strong>
            </th>
            <td>
              {{term.course.credits}} hours of work / week
          </td></tr>
          <tr><th>
              <strong>Departments Offered</strong>
            </th>
            <td>
              {{#each term.departments}}
                {{this.name}}   &nbsp;
              {{/each}}
          </td></tr>
          {{#unless term.faculty}}
            <tr id="term_subscription_status">
            </tr>
          {{/unless}}
        </table>
      </div>
      <div class="tab-pane {{#if tab.instructor}}active{{/if}}" id="instructor">
        {{#each term.instructors}}
          <h4>{{this.instructor}} <small>({{this.email}})</small></h4>
          {{{this.about}}}
        {{/each}}
      </div>
      <div class="tab-pane {{#if tab.outline}}active{{/if}}" id="outline">
        <ul class="nav nav-tabs">
          <li><h4>Outline Of Topics</h4></li>
          <li class="active pull-right"><a href="#edit_outline" data-toggle="tab">Edit</a></li>
          <li class="pull-right"><a href="#view_outline" data-toggle="tab">View</a></li>
        </ul>
        <div class="tab-content" style="border: 0;">
          <div class="tab-pane fade" id="view_outline">
            {{#if term.sections}}
              <ul>
                {{#each term.sections}}
                  <li>
                    {{title}}
                    <ul>
                      {{#each topics}}
                        <li><span class="text-muted">{{ct_status}} - </span>{{title}}</li>
                      {{/each}}
                    </ul>
                  </li>
                {{/each}}
              </ul>
            {{else}}
              <p>Sorry, this course doesn&#39;t seem to have topics.</p>
            {{/if}}
          </div>
          <div class="tab-pane fade in active" id="edit_outline">
            <div class="row">
              <div class="col-md-4">
                <div class="panel panel-info">
                  <div class="panel-heading">Topics</div>
                  <div class="list-group">
                    {{#each term.sections}}
                      <a class="list-group-item" href="#_section_{{id}}" data-toggle="tab">{{title}}</a>
                    {{/each}}
                    <div class="list-group-item">

                      <form class="form-inline create_section">
                        <div class="input-group">
                          <input type="text" class="form-control" id="new_section_title" placeholder="New Topic Title">
                          <div class="input-group-btn">
                            <button type="submit" class="btn btn-default">
                              <i class="glyphicon glyphicon-chevron-right"></i>
                            </button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-md-8">
                <div class="tab-content" style="padding: 0; border: 0;">
                  <div class="tab-pane active">
                      <div class="panel panel-default">
                        <div class="panel-heading" style="padding-top: 100px; padding-bottom:100px; text-align: center; ">
                          <p class="lead">Select a Section from the left.</p>
                        </div>
                      </div>
                  </div>

                  {{#each term.sections}}
                    <div class="tab-pane" id="_section_{{id}}">
                      <div class="panel panel-info">
                        <div class="panel-heading">
                          <ul class="panel-heading-actions pull-right">
                            <li class="edit_section" section-id="{{id}}"><i class="glyphicon glyphicon-pencil"></i></li>
                            <li class="delete_section" section-id="{{id}}"><i class="glyphicon glyphicon-remove-circle"></i></li>
                          </ul>
                          {{title}}
                        </div>
                        <div class="list-group">
                          {{#each topics}}
                            <span class="list-group-item">
                              {{title}}<span class="text-muted"> - {{ct_status}}</span>
                            </span>
                          {{/each}}

                          <div class="list-group-item">
                            <form id="add_subtopic_{{id}}" class="create_subtopic" section-id="{{id}}">
                              <div class="field">
                                <div class="input-group input-group-sm">
                                  <div class="input-group-btn ct_select_btn">
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                      <span>CT 1</span>
                                      <i class="caret"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                      <li><a href="#">CT 1</a></li>
                                      <li><a href="#">CT 2</a></li>
                                      <li><a href="#">Post CT</a></li>
                                    </ul>
                                  </div>
                                  <input type="hidden" value="CT 1" id="topic_ct_status">
                                  <input type="text" value="" class="form-control" placeholder="SubTopic Title" id="topic_title">
                                  <div class="input-group-btn">
                                    <button type="submit" class="btn btn-success">Add <i class="glyphicon glyphicon-chevron-right"></i></button>
                                  </div>
                                </div>
                              </div>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
                  {{/each}}
                </div>
              </div>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>
</script>

<script type="text/template" id="term-topics-template">
  <div class="row">
    <div class="list-group local-nav col-md-3">
      <a class="list-group-item {{#if show_all}}active{{/if}}" href="#_all_sections" data-toggle="tab">All</a>
      {{#each term_sections}}
        <a class="list-group-item {{#if this.active}}active{{/if}}" href="#_section_{{this.id}}" data-toggle="tab"{{#if this.show_short_title}} title="{{this.title}}"{{/if}}>
          <span class="badge">{{this.topics.length}}</span>
          {{this.short_title}}
        </a>
      {{/each}}
    </div>
    <div class="tab-content col-md-9">
      <div id="topic_filter row">
        <div class="pull-right col-md-5">
          <label class="muted">Filters:</label>
          <div id="ct_status_selector" class="btn-group" data-toggle="buttons">
            <label class="btn btn-default {{#if selectors.ct_status.ct1}}active{{/if}}">
              <input type="checkbox"> CT 1
            </label>
            <label class="btn btn-default {{#if selectors.ct_status.ct2}}active{{/if}}">
              <input type="checkbox"> CT 2
            </label>
            <label class="btn btn-default {{#if selectors.ct_status.postct}}active{{/if}}">
              <input type="checkbox"> Post CT
            </label>
          </div>
        </div>
        <div class="input-group col-md-6">
          <span class="input-group-addon glyphicon glyphicon-search" style="top: 0;"></span>
          <input type="search" class="form-control" placeholder="Search a Topic" id="search_box" onfocus="this.value = this.value;">
        </div>
      </div>

      {{#unless term_sections}}
        <div class="tab-pane active _topic_list" id="_topic_all">
          <table class="table bottom_line">
            <tbody>
              <tr><td>
                  No topics were found that matched the given criteria.
              </td></tr>
            </tbody>
          </table>
        </div>
      {{/unless}}
      <div class="tab-pane _topic_list {{#if show_all}}active{{/if}}" id="_all_sections">
        {{#each term_sections}}
          <div class="panel">
            <h4>{{title}}</h4>
          </div>
          {{#each this.topics}}
            {{#show_topic}}{{/show_topic}}
          {{/each}}
        {{/each}}
      </div>


      {{#each term_sections}}
        <div class="tab-pane _topic_list {{#if this.active}}active{{/if}}" id="_section_{{this.id}}">
          <div class="panel">
            <h4>{{this.title}}</h4>
          </div>
          
          {{#unless this.topics}}
            <div class="panel panel-default">
              <div class="panel-body">
                No topics found under this section
              </div>
            </div>
          {{/unless}}
          {{#each this.topics}}
            {{#show_topic}}{{/show_topic}}
          {{/each}}
        </div>
      {{/each}}
    </div>
  </div>
</script>

<script type="text/template" id="topic-template">
  <div class="panel panel-default" id="topic_{{topic.id}}">
    <div class="panel-heading">
      {{#if faculty}}
        <div class="pull-right">
          <ul class="panel-heading-actions">
            <li><i class="glyphicon glyphicon-pencil toggle_edit_topic" topic-id="{{topic.id}}"></i></li>
            <li><i class="glyphicon glyphicon-remove-circle delete_topic" topic-id="{{topic.id}}"></i></li>
          </ul>
        </div>
      {{/if}}
      <a href="#topic_{{topic.id}}" style="color:#333;">{{topic.title}}</a>
      <small class="text-muted">- {{topic.ct_status}}</small>
    </div>
    {{#if topic.edit}}
      <div class="panel-body">
        <form>
          <div class="field">
            <div class="input-group">
              <div class="input-group-btn ct_select_btn">
                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                  <span>{{topic.ct_status}}</span>
                  <i class="caret"></i>
                </button>
                <ul class="dropdown-menu">
                  <li><a href="#">CT 1</a></li>
                  <li><a href="#">CT 2</a></li>
                  <li><a href="#">Post CT</a></li>
                </ul>
              </div>
              <input type="hidden" value="{{topic.ct_status}}" id="topic_ct_{{topic.id}}">
              <input type="text" value="{{topic.title}}" class="form-control" placeholder="Topic Title" id="topic_title_{{topic.id}}">
            </div>
          </div>
          <div class="field">
            <select multiple=true class="selectpicker show-tick show-menu-arrow" data-live-search="true" data-width='auto' title="Select Related Note(s)" data-header="Select Related Note(s)" id="topic_notes_{{topic.id}}">
              {{#each topic.notes}}
                <option value="{{this.note_id}}" {{#if this.id}}selected{{/if}}>{{this.name}}</option>
              {{/each}}
            </select>
          </div>
          <div class="form-group">
            <p class="help-block small pull-right">*Description is parsed with <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet" class="external" target="_blank">Markdown</a></p>
            <textarea id="topic_description_{{topic.id}}" class="form-control" rows="8">{{topic.description}}</textarea>
          </div>

        </form>
      </div>
      <div class="list-group">
        {{#each topic.reference}}
        <div class="list-group-item">
          <div class="media">
            <i class="glyphicon glyphicon-book pull-left media-object"></i>
            <div class="media-body">
              <div class="list-group-item-heading">{{book}}</div>
              <input type="text" value="{{indices}}" term-ref-id="{{term_ref_id}}" book-name="{{book}}" topic-id="{{../id}}" book-id="{{book_id}}" ref-id="{{id}}" class="form-control input-sm topic_reference" placeholder="Index/Page no.">
            </div>
          </div>
        </div>
        {{/each}}
      </div>
      <div class="panel-footer">
        <div class="btn btn-success btn-sm pull-right edit_topic" topic-id="{{topic.id}}">
          <i class="glyphicon glyphicon-ok"></i> Save
        </div>
        <div class="btn btn-default btn-sm toggle_edit_topic" topic-id="{{topic.id}}">
          <i class="glyphicon glyphicon-remove"></i> Cancel
        </div>
      </div>
    {{/if}}
    {{#unless topic.edit}}
      {{#if topic.description}}
        <div class="panel-body">
          <p>{{{toMarkdown topic.description}}}</p>
        </div>
      {{/if}}
    
      <div class="list-group">
        {{#each topic.reference}}
          <div class="list-group-item">
            <div class="media">
              <i class="glyphicon glyphicon-book pull-left media-object"></i>
              <div class="media-body">
                <div class="list-group-item-heading">{{this.book}}</div>
                <p class="list-group-item-text">{{this.indices}}</p>
              </div>
            </div>
          </div>
        {{/each}}
        {{#each topic.notes}}
          <div class="list-group-item">
            <div class="media">
              <i class="fa fa-book fa-2x pull-left media-object"></i>
              <div class="media-body">
                <div class="list-group-item-heading">{{name}}</div>
                <p class="list-group-item-text">
                  <a class="external" href="{{this.url}}" target="_blank">Download</a> |
                  <a class="external" href="http://docs.google.com/viewer?url={{../../../../../host}}{{this.url}}" target="_blank">Read</a>
                </p>
              </div>
            </div>
          </div>
        {{/each}}
      </div>
    {{/unless}}
  </div>
</script>

<script type="text/template" id="term-classes-template">
  <table class="table bottom_line">
    <tbody>
      {{#unless term.classes}}
        <tr><td>
          No classes have been taught in this course this semester.
        </td></tr>
      {{/unless}}
      {{#each term.classes}}
        <tr><td>
          <dl>
            <dt>
              {{this.date}}, {{this.time}}
              <small>at {{this.room}}</small>
            </dt>
            <dd>
              <strong>
                Topics covered
              </strong>
              <ul>
                {{#each this.topics}}
                  <li>
                    {{this.title}}
                  </li>
                {{/each}}
              </ul>
            </dd>
          </dl>
        </td></tr>
      {{/each}}
    </tbody>
  </table>
</script>

<script type="text/template" id="term-reference-template">
  <div class="row">
    <div class="list-group local-nav col-md-3">
      <a href="#_reference_books" class="list-group-item {{#if tab.books}}active{{/if}}" data-toggle="tab">Books <small class="badge">{{term.course.reference_books.length}}</small></a>
      <a href="#_reference_notes" class="list-group-item {{#if tab.notes}}active{{/if}}" data-toggle="tab">Notes <small class="badge">{{term.attachments.length}}</small></a>
    </div>
    <div class="tab-content col-md-9">
      <div class="tab-pane {{#if tab.books}}active{{/if}} _reference_list" id="_reference_books">
        {{#if term.course.reference_books.length}}
          <table class="table bottom_line">
            <tbody>
              {{#each term.course.reference_books}}
                <tr><td style="padding-right: 20px; ">
                  <h4>{{title}} <small>({{year}})</small></h4>
                  <table class="table table-striped table-condensed">
                    <tbody>
                      <tr><th width="30%">Authors</th><td>
                        <ul style="padding-left: 15px;">
                          {{#each authors}}
                            <li>{{name}}</li>
                          {{/each}}
                        </ul>
                      </td></tr>
                      <tr><th>Publisher</th><td>{{publisher}}</td></tr>
                      <tr><th>Edition</th><td>{{edition}}</td></tr>
                      {{#if isbn-10}}
                        <tr><th>ISBN-10</th><td>{{isbn-10}}</td></tr>
                      {{/if}}
                      {{#if isbn-13}}
                        <tr><th>ISBN-13</th><td>{{isbn-13}}</td></tr>
                      {{/if}}
                    </tbody>
                  </table>
                </td>
                {{#if this.cover}}
                  <td><img src="{{this.cover}}"></td>
                {{else}}
                  <td></td>
                {{/if}}
                </tr>
              {{/each}}
            </tbody>
          </table>
        {{else}}
          <table class="table bottom_line">
            <tbody>
              <tr><td style="padding: 20px;">
                No Reference material found for this subject.
              </td></tr>
            </tbody>
          </table>
        {{/if}}
      </div>
      <div class="tab-pane {{#if tab.notes}}active{{/if}} _reference_list" id="_reference_notes">
        <table class="table bottom_line">
          <tbody>
            {{#if term.attachments.length}}
              {{#each term.attachments}}
                <tr>
                  <td style="padding-right: 20px; ">
                    <strong>{{this.name}}</strong>
                  </td>
                  <td>
                    <a class="external" href="{{this.url}}" target="_blank">Download</a> | <a class="external" href="{{ previewUrl this.url this.name}}" target="_blank">Read</a>
                  </td>
                </tr>
              {{/each}}
            {{else}}
              No Notes found
            {{/if}}
          </tbody>
          <div class="field">
            <div id="upload_notes">
          </div>
        </table>
      </div>
    </div>
  </div>
</script>

<script type="text/template" id="profile-template">
  {{#if info.found}}
    {{#if edit_mode}}
      <div class="row">
        <div class="col-md-3">
          <div class="field">
            <img {{#if avatar}}src='{{info.avatar}}'{{else}}src="<%= asset_path 'default_profile.jpg' %>"{{/if}} id="avatar">
          </div>
          <div class="field">
            <div id="upload_avatar"></div>
          </div>
        </div>
        <div class="col-md-9">
          {{#if info.student}}
            <fieldset>
              <legend>Edit Profile Info</legend>
              <div class="field">
                <input type="text" class="form-control" value="{{info.name}}" placeholder="Name" id="name">
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.email}}" id="email" disabled>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.department}}" id="department" disabled>
              </div>
              <div class="field">
                <input type="tel" class="form-control" value="{{info.phone}}" placeholder="Phone" id="phone">
              </div>
              <div class="field">
                <a class="btn btn-default btn-success" id="save" href="javascript:history.back()">Save</a>
              </div>
            </fieldset>
          {{else}}
            <fieldset>
              <legend>Edit Profile Info</legend>
              <div class="field">
                <select type="text" class="selectpicker show-tick show-menu-arrow" title="Select Prefix" data-header="Select Prefix" id="prefix">
                  {{#each prefix}}
                    <option value={{@key}} {{#if this}}selected{{/if}}>{{@key}}</option>
                  {{/each}}
                </select>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.name}}" placeholder="Name" id="name">
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.email}}" id="email" disabled>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.department}}" id="department" disabled>
              </div>
              <div class="field">
                <input type="tel" class="form-control" value="{{info.phone}}" placeholder="Phone" id="phone">
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.designation}}" placeholder="Designation" id="designation">
              </div>
              <div class="form-group">
                <p class="help-block small pull-right">*About section is parsed with <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet" class="external" target="_blank">Markdown</a></p>
                <textarea class="form-control" placeholder="About You" id="about" rows="12">{{info.about}}</textarea>
              </div>
              <div class="field">
                <a class="btn btn-default btn-success" id="save" href="javascript:history.back()">Save</a>
              </div>
            </fieldset>
          {{/if}}
          <br>
          <br>
          <fieldset>
            <legend>Settings</legend>
            <div class="field">
              Send Email Notifications : 
              <div class="make-switch" data-on="success" data-off="warning">
                <input type="checkbox" checked="checked" disabled>
              </div>
            </div>
            <div class="field">
              Send SMS Notifications :
              <div class="make-switch" data-on="success" data-off="warning">
                <input type="checkbox" disabled>
              </div>
            </div>
          </fieldset>
        </div>
      </div>
    {{else}}
      {{#if info.edit}}
        <div class="row">
          <div class="pull-right field"><a href="/profile/{{info.email}}/edit" class="btn btn-default btn-primary" id="edit">Edit</a></div>  
        </div>
      {{/if}}
      <div class="row">
        <div class="col-md-3">
          <img {{#if avatar}}src='{{info.avatar}}'{{else}}src="<%= asset_path 'default_profile.jpg' %>"{{/if}} id="avatar">
        </div>
        <div class="col-md-9">
          <table class="table table-striped">
            <tbody>
              {{#if info.student}}
                <tr>
                  <th>Name</th>
                  <td>{{info.name}}</td>
                </tr>
                <tr>
                  <th>Department</th>
                  <td>{{info.department}} ({{info.department_short}})</td>
                </tr>
                <tr>
                  <th>Email</th>
                  <td>{{info.email}}@nitt.edu</td>
                </tr>
                <tr>
                  <th>Status</th>
                  <td>Student</td>
                </tr>
                <tr>
                  <th>Currently Attending Courses</th>
                  <td class="text-info">
                    {{#each info.subs}}
                      {{#if this.current}}
                        <a href="/terms/{{this.term_id}}">{{this.course_name}}</a>
                        -
                        <i>{{this.year}}</i> - {{this.sem}} semester<br>
                      {{/if}}
                    {{/each}}
                  </td>
                </tr>
                <tr>
                  <th>Courses Completed</th>
                  <td class="text-muted">
                    {{#each info.subs}}
                      {{#unless this.current}}
                        {{#unless this.this_year}}
                          <a href="/terms/{{this.term_id}}" class="text-muted">{{this.course_name}}</a>
                          -
                          <i>{{this.year}}</i> - {{this.sem}} semester<br>
                        {{/unless}}
                      {{/unless}}
                    {{/each}}
                  </td>
                </tr>
              {{else}}
                <tr>
                  <th>Name</th>
                  <td>{{info.prefix}} {{info.name}}</td>
                </tr>
                <tr>
                  <th>Department</th>
                  <td>{{info.department}}({{info.department_short}})</td>
                </tr>
                <tr>
                  <th>Email</th>
                  <td>{{info.email}}@nitt.edu</td>
                </tr>
                <tr>
                  <th>Status</th>
                  <td>Faculty</td>
                </tr>
                <tr>
                  <th>Designation</th>
                  <td>{{info.designation}}</td>
                </tr>
                <tr>
                  <th>About</th>
                  <td>{{{toMarkdown info.about}}}</td>
                </tr>
                <tr>
                  <th>Courses Handling</th>
                  <td>
                    {{#each info.classes}}
                      {{#if this.current}}
                        <a href="/terms/{{this.term_id}}">{{this.course_name}}</a>
                        -
                        <span class="text-info"><i>{{this.year}}</i> - {{this.sem}} semester</span>
                        <br>
                      {{/if}}
                    {{/each}}
                  </td>
                </tr>
                <tr>
                  <th>Courses Handled</th>
                  <td class="text-muted">
                    {{#each info.classes}}
                      {{#unless this.current}}
                        {{#unless this.this_year}}
                          <a href="/terms/{{this.term_id}}" class="text-muted">{{this.course_name}}</a>
                          -
                          <span><i>{{this.year}}</i> - {{this.sem}} semester</span>
                          <br>
                        {{/unless}}
                      {{/unless}}
                    {{/each}}
                  </td>
                </tr>
              {{/if}}
            </tbody>
          </table>
        </div>
      </div>
    {{/if}}
  {{else}}
    <div>User not found</div>
  {{/if}}
</script>

<script type="text/template" id="404-template">
  <h3 style="font-size: 60px; margin: 30px; ">Its a 404!</h3>
  <p class="lead">This means, the page you&#39;re trying to access does not exist!</p>
  <div>
    <a href="javascript:history.back()" class="btn btn-default">
      <i class="glyphicon glyphicon-chevron-left"></i> Back
    </a>
    <a href="/" class="btn btn-default">
      <i class="glyphicon glyphicon-home"></i> Home
    </a>
  </div>
</script>

<script type="text/template" id="500-template">
  <h3 style="font-size: 60px; margin: 30px; ">Its a 500!</h3>
  <p class="lead">The server is experiencing some problem. Please contact the site admin/support</p>
  <div>
    <a href="javascript:history.back()" class="btn btn-default">
      <i class="glyphicon glyphicon-chevron-left"></i> Back
    </a>
    <a href="/" class="btn btn-default">
      <i class="glyphicon glyphicon-home"></i> Home
    </a>
  </div>
</script>

