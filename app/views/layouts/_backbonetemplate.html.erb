<script type="text/template" id="login-template">
  <div class="container">
    <form action="/authenticate" method="post" role="form" class="col-md-3 form-signin" style="text-align: center; ">
      <h2 class="form-signin-heading">Sign In</H2>
      <% unless flash[:notice].nil? %>
        <div class="alert <%= flash[:notice_type] %>">
          <%= flash[:notice] %>
        </div>
      <% end %>
      <div class="form-group">
        <div class="input-group">
          <input type="text" name="username" style="text-align: right;" class="form-control" placeholder="webmail id" autofocus autocomplete="off">
          <span class="input-group-addon">@nitt.edu</span>
        </div>
        <input type="password" name="password" class="form-control" placeholder="password" style="text-align: center; ">
      </div>
      <button type="submit" class="btn btn-lg btn-primary btn-block">Sign In</button>
    </form>
  </div>
</script>
  
<script type="text/template" id="departments-template">
  <div class="s-push"></div>
  <div class="panel panel-default">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Department</th>
          <th>HOD</th>
        </tr>
      </thead>
      <tbody>
        {{#each depts}}
          <tr>
            <td>
              <a href="/departments/{{this.id}}">{{this.name}}</a>
            </td>
            <td>{{this.hod}}</td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</script>

<script type="text/template" id="department-template">
  <h3 style="font-weight: 400; ">
    <a href="/departments" class="btn btn-default btn-small" title="Department List">
      <i class="glyphicon glyphicon-chevron-left"></i>
    </a>
    <small>{{dept.short}}</small>
    {{dept.name}}
  </h3>
  <div>
    Headed by <strong>{{dept.hod}}</strong>
  </div>
  <div class="s-push"></div>

  <table class="table table-hover">
    <caption>
      <h3>Courses Offered</h3>
    </caption>
    <thead>
      <tr>
        <th>Course</th>
        <th>Course Instructor</th>
        <th># credits</th>
      </tr>
    </thead>
    <tbody>
      {{#each dept.course_listing}}
        <tr><th colspan="3">{{this.semester}}</th></tr>
        {{#each this.course_list}}
          <tr>
            <td>
              <a href="/terms/{{this.term_id}}">
                {{this.code}} - {{this.name}}
              </a>
            </td>
            <td>
              <small>
                {{#each this.instructors}}
                  <div>{{this.name}}</div>
                {{/each}}
              </small>
            </td>
            <td>{{this.credits}}</td>
          </tr>
        {{/each}}
      {{/each}}
    </tbody>
  </table>
</script>


<script type="text/template" id="course-template">
  <h3>
    <small>{{course.code}}</small>
    {{course.name}}
  </h3>

  <ul class="nav nav-tabs" id="specialized_view_selector">
    <li class="span2">
      <span class="nav_container">
        <strong class="label label-default">{{course.credits}} credits</strong>
      </span>
    </li>
    <li id="view_course_info"><a href="/courses/{{course.id}}/info">Info</a></li>
    <li id="view_course_topics"><a href="/courses/{{course.id}}/topics">Topics</a></li>
    <li id="view_course_reference"><a href="/courses/{{course.id}}/reference">
        Reference Material
        <small class="badge">{{course.reference_books.length}}</small>
      </a>
    </li>
  </ul>
  <div id="specialized_view"></div>
</script>


<script type="text/template" id="course-info-template">
  <div>
    <h4>Overview</h4>
    <table class="table bottom_line">
      <tr>
        <td colspan="2">
          {{{course.about}}}
        </td>
      </tr>
      <tr>
        <th>
          <strong>Departments Offered</strong>
        </th>
        <td>
          {{#each course.departments}}
            {{this.name}}
          {{/each}}
        </td>
      </tr>
    </table>
  </div>
</script>

<script type="text/template" id="course-topics-template">
  {{#if course.sections}}
    <div class="row">
      <ul class="nav nav-pills nav-stacked local-nav col-md-3">
        <li class="{{#unless course_sections}}active{{/unless}}"><a href="#_all_sections" data-toggle="tab">All</a></li>
        {{#each course.sections}}
          <li class="{{#if this.active}}active{{/if}}">
            <a href="#_section_{{this.id}}" data-toggle="tab">
              <div class="badge pull-right">{{this.topics.length}}</div>
              {{this.short_title}}
            </a>
          </li>
        {{/each}}
      </ul>
      <div class="tab-content col-md-9">
        <div class="tab-pane active _topic_list" id="_all_sections">
          <table class="table bottom_line">
            <tbody>
              {{#each course.sections}}
                {{#each this.topics}}
                  <tr>
                    <td>
                      <dl>
                        <dt>
                          {{this.title}}
                        </dt>
                        <dd>
                          <p>{{this.description}}</p>
                          <table class="table table-bordered">
                            <thead>
                              <tr>
                                {{#each this.reference}}
                                  <th><small>{{this.book}}</small></th>
                                {{/each}}
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                {{#each this.reference}}
                                  <td><small>{{this.indices}}</small></td>
                                {{/each}}
                              </tr>
                            </tbody>
                          </table>
                        </dd>
                      </dl>
                    </td>
                  </tr>
                {{/each}}
              {{/each}}
            </tbody>
          </table>
        </div>


        {{#each course.sections}}
          <div class="tab-pane _topic_list" id="_section_{{this.id}}">
            <table class="table bottom_line">
              <tbody>
                <tr><td>
                  <h4>{{this.title}}</h4>
                </td></tr>
                {{#unless this.topics}}
                  <tr><td>
                    No topics found under this section
                  </td></tr>
                {{/unless}}
                {{#each this.topics}}
                  <tr><td>
                    <dl>
                      <dt>{{this.title}}</dt>
                      <dd>
                        <p><small>
                          {{#if this.classes}}
                            This topic was taught on
                            {{#each this.classes}}
                              {{this.date}}
                            {{/each}}
                          {{else}}
                            This topic has not been taught so far this semester
                          {{/if}}
                        </small></p>
                        <p>{{this.description}}</p>
                        <table class="table table-bordered">
                          <thead><tr>
                            {{#each this.reference}}
                              <th><small>{{this.book}}</small></th>
                            {{/each}}
                          </tr></thead>
                          <tbody><tr>
                            {{#each this.reference}}
                              <td><small>{{this.indices}}</small></td>
                            {{/each}} 
                          </tr></tbody>
                        </table>
                      </dd>
                    </dl>
                  </td></tr>
                {{/each}}
              </tbody>
            </table>
          </div>
        {{/each}}
      </div>
    </div>
  {{else}}
    <table class="table bottom_line">
      <tbody>
        <tr><td style="padding: 20px;">
          No topic found for this course.
        </td></tr>
      </tbody>
    </table>
  {{/if}}
</script>

<script type="text/template" id="course-reference-template">
  {{#unless course.reference_books}}
  
    <table class="table bottom_line">
      <tbody><tr><td style="padding: 20px;">
        No Reference material found for this subject.
      </td></tr></tbody>
    </table>

  {{else}}

    <div class="row">
      <ul class="nav nav-pills nav-stacked col-md-3 local-nav">
        <li class="active"><a href="#_reference_books" data-toggle="tab">Books</a></li>
      </ul>
      <div class="tab-content col-md-9">
        <div class="tab-pane active _reference_list" id="_reference_books">
          <table class="table bottom_line">
            <tbody>
              {{#each course.reference_books}}
                <tr><td style="padding-right: 20px; " >
                  <h4>{{this.title}} <small>({{this.year}})</small></h4>
                  <table class="table table-striped table-condensed">
                    <tbody>
                      <tr><th width="30%">Authors</th><td>
                        <ul style="padding-left: 15px;">
                          {{#each this.authors}}
                            <li>{{this.name}}</li>
                          {{/each}}
                        </ul>
                      </td></tr>
                      <tr><th>Publisher</th><td>{{this.publisher}}/</td></tr>
                      <tr><th>Edition</th><td>{{this.edition}}</td></tr>
                      <tr><th>ISBN</th><td>{{this.isbn}}</td></tr>
                    </tbody>
                  </table>
                </td></tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>

  {{/unless}}
</script>


<script type="text/template" id="term-template">
  <h3>
    <a href="/terms/{{term.id}}/topics{{#unless edit_mode}}/edit{{/unless}}" class="btn {{#if edit_mode}}btn-success{{else}}btn-default greener{{/if}} btn-small">
      <i class="glyphicon glyphicon-pencil"></i>
    </a>
    <small>{{term.course.code}}</small>
    {{term.course.name}}
  </h3>
  <div class="pull-right" id="term_subscription_status"></div>
  {{#if term.instructors}}
    <p>
      <strong>Course Instructor:</strong>
      {{#each term.instructors}}
      <span>{{this.instructor}}</span>
      {{/each}}
    </p>
  {{/if}}

  <ul class="nav nav-tabs" id="specialized_view_selector">
    <li class="span2">
      <span class="nav_container">
        <p class="label label-default">{{term.course.credits}} credits</p>
      </span>
    </li>
    <li id="view_term_info"><a href="/terms/{{term.id}}/info">Info</a></li>
    <li id="view_term_topics"><a href="/terms/{{term.id}}/topics">Topics</a></li>
    <li id="view_term_classes"><a href="/terms/{{term.id}}/classes">Classes</a></li>
    <li id="view_term_reference"><a href="/terms/{{term.id}}/reference">
      Reference Material
      <small class="badge">{{term.course.reference_books.length}}</small>
    </a></li>
  </ul>
  <div id="specialized_view" class="{{edit_mode}}"></div>
</script>

<script type="text/template" id="term-subscription-template">
    <button class="btn btn-default {{#if sub}}btn-success{{/if}}" id="subscription_status" data-placement="left" data-trigger="hover" data-toggle="tooltip" data-container="body">{{text}}</button>
</script>

<script type="text/template" id="term-info-template">
  <div class="row">
    <ul class="nav nav-pills nav-stacked local-nav col-md-3">
      <li class="active"><a href="#info1" data-toggle="tab">Overview</a></li>
      <li><a href="#info2" data-toggle="tab">Instructor</a></li>
      <li><a href="#info3" data-toggle="tab">Outline</a></li>
    </ul>
    <div class="tab-content col-md-9">
      <div class="tab-pane active" id="info1">
        <h4>Overview</h4>
        <table class="table bottom_line">
          <tr>
            <td colspan="2">
              {{{term.course.about}}}
            </td>
          </tr>
          <tr>
            <th>
              <strong>Course Instructor</strong>
            </th>
            <td>
              {{#each term.instructors}}
              {{this.instructor}}
              {{/each}}
            </td>
          </tr>
          <tr>
            <th>
              <strong>Departments Offered</strong>
            </th>
            <td>
              {{#each term.departments}}
              {{this.name}}
              {{/each}}
            </td>
          </tr>
        </table>
      </div>
      <div class="tab-pane" id="info2">
        {{#each term.instructors}}
          <h4>{{this.instructor}}</h4>
          {{{this.about}}}
        {{/each}}
      </div>
      <div class="tab-pane" id="info3">
        <h4>Outline</h4>
      </div>
    </div>
  </div>
</script>

<script type="text/template" id="term-topics-template">
  <div class="row">
    <div class="list-group local-nav col-md-3">
      {{#unless edit_mode}}
        <a class="list-group-item {{#if show_all}}active{{/if}}" href="#_all_sections" data-toggle="tab">All</a>
      {{/unless}}
      {{#each term_sections}}
        <a class="list-group-item {{#if this.active}}active{{/if}}" href="#_section_{{this.id}}" data-toggle="tab"{{#if this.show_short_title}} title="{{this.title}}"{{/if}}>
          <span class="badge">{{this.topics.length}}</span>
          {{this.short_title}}
        </a>
      {{/each}}
    </div>
    <div class="tab-content col-md-9">
      <div id="topic_filter">
        <div class="pull-right">
          <label class="muted">Filters:</label>
          <div id="ct_status_selector" class="btn-group" title="You can choose multiple options at once">
            <button class="{{selectors.ct_status.ct1}} btn btn-default btn-small">CT 1</button>
            <button class="{{selectors.ct_status.ct2}} btn btn-default btn-small">CT 2</button>
            <button class="{{selectors.ct_status.postct}} btn btn-default btn-small">Post CT</button>
          </div>
        </div>
        <div class="input-group">
          <span class="input-group-addon glyphicon glyphicon-search" style="top: 0;"></span>
          <input type="search" class="form-control" placeholder="Search a Topic">
        </div>
      </div>
      {{#unless edit_mode}}
        {{#unless term_sections}}
          <div class="tab-pane active _topic_list" id="_topic_all">
            <table class="table bottom_line">
              <tbody>
                <tr><td>
              No topics were found that matched the given criteria.
                </td></tr>
              </tbody>
            </table>
          </div>
        {{/unless}}
        <div class="tab-pane _topic_list {{#if show_all}}active{{/if}}" id="_all_sections">
          <table class="table bottom_line">
            <tbody>
              {{#each term_sections}}
                {{#each this.topics}}
                  <tr><td>
                    <dl>
                      <dt>
                        {{this.title}}
                        <span class="label label-success">{{this.ct_status}}</span>
                      </dt>
                      <dd>
                        <p>
                          <small>
                            {{#if this.classes}}
                            This topic was taught on
                            {{#each this.classes}}
                            {{this.date}}
                            {{/each}}
                            
                            {{else}}
                            This topic has not been taught so far this semester
                            {{/if}}
                          </small>
                        </p>
                        
                        <p>{{this.description}}</p>
                        <table class="table table-bordered">
                          <thead><tr>
                            {{#each this.reference}}
                              <th><small>{{this.book}}</small></th>
                            {{/each}}
                          </tr></thead>
                          <tbody><tr>
                            {{#each this.reference}}
                              <td><small>{{this.indices}}</small></td>
                            {{/each}}
                          </tr></tbody>
                        </table>
                      </dd>
                    </dl>
                  </td></tr>
                {{/each}}
              {{/each}}
            </tbody>
          </table>
        </div>
      {{/unless}}


      {{#each term_sections}}
        <div class="tab-pane _topic_list {{#if this.active}}active{{/if}}" id="_section_{{this.id}}">
          <table class="table bottom_line">
            <tbody>
              <tr><td>
                {{#if ../edit_mode}}
                  <div class="btn-group pull-right">
                    <div class="btn btn-default btn-small">
                      <i class="glyphicon glyphicon-pencil"></i>
                    </div>
                    <div class="btn btn-small btn-danger" data-toggle="popover" data-placement="left" data-html="true" data-content='Are you sure you want to delete this Topic? <small class="text-danger">This is irreversible</small><div><button class="btn btn-danger">Delete</button></div>'>
                      <i class="glyphicon glyphicon-trash glyphicon-white"></i>
                    </div>
                  </div>
                {{/if}}
                <h4>{{this.title}}</h4>
              </td></tr>
              {{#unless this.topics}}
                <tr><td>
                  No topics found under this section
                </td></tr>
              {{/unless}}
              {{#each this.topics}}
                <tr><td>
                  <dl>
                    <dt>
                      {{#if ../../edit_mode}}
                        <div class="btn-group pull-right">
                          <div class="btn btn-default btn-mini">
                            <i class="glyphicon glyphicon-pencil"></i>
                          </div>
                          <div class="btn btn-default btn-mini">
                            <i class="glyphicon glyphicon-move"></i>
                          </div>
                          <div class="btn btn-danger btn-mini">
                            <i class="glyphicon glyphicon-trash glyphicon-white"></i>
                          </div>
                        </div>
                      {{/if}}
                      {{this.title}}
                      <span class="label label-success">{{this.ct_status}}</span>
                    </dt>
                    <dd>
                      <p>
                        <small>
                          {{#if this.classes}}
                            This topic was taught on
                            {{#each this.classes}}
                              {{this.date}}
                            {{/each}}
                            
                          {{else}}
                            This topic has not been taught so far this semester
                          {{/if}}
                        </small>
                      </p>
                      <p>{{this.description}}</p>
                      <table class="table table-bordered">
                        <thead><tr>
                          {{#each this.reference}}
                            <th><small>{{this.book}}</small></th>
                          {{/each}}
                        </tr></thead>
                        <tbody><tr>
                          {{#each this.reference}}
                            <td><small>{{this.indices}}</small></td>
                          {{/each}}
                        </tr></tbody>
                      </table>
                    </dd>
                  </dl>
                </td></tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      {{/each}}
    </div>
  </div>
</script>

<script type="text/template" id="term-classes-template">
  <table class="table bottom_line">
    <tbody>
      {{#unless term.classes}}
        <tr><td>
          No classes have been taught in this course this semester.
        </td></tr>
      {{/unless}}
      {{#each term.classes}}
        <tr><td>
          <dl>
            <dt>
              {{this.date}}, {{this.time}}
              <small>at {{this.room}}</small>
            </dt>
            <dd>
              <strong>
                Topics covered
              </strong>
              <ul>
                {{#each this.topics}}
                  <li>
                    {{this.title}}
                  </li>
                {{/each}}
              </ul>
            </dd>
          </dl>
        </td></tr>
      {{/each}}
    </tbody>
  </table>
</script>

<script type="text/template" id="term-reference-template">
  {{#unless term.course.reference_books}}
  
    <table class="table bottom_line">
      <tbody>
        <tr><td style="padding: 20px;">
          No Reference material found for this subject.
        </td></tr>
      </tbody>
    </table>

  {{else}}
  
    <div class="row">
      <ul class="nav nav-pills nav-stacked local-nav col-md-3">
        <li class="active"><a href="#_reference_books" data-toggle="tab">Books</a></li>
      </ul>
      <div class="tab-content col-md-9">
        <div class="tab-pane active _reference_list" id="_reference_books">
          <table class="table bottom_line">
            <tbody>
              {{#each term.course.reference_books}}
                <tr><td style="padding-right: 20px; ">
                  <h4>{{this.title}} <small>({{this.year}})</small></h4>
                  <table class="table table-striped table-condensed">
                    <tbody>
                      <tr><th width="30%">Authors</th><td>
                        <ul style="padding-left: 15px;">
                          {{#each this.authors}}
                            <li>{{this.name}}</li>
                          {{/each}}
                        </ul>
                      </td></tr>
                      <tr><th>Publisher</th><td>{{this.publisher}}</td></tr>
                      <tr><th>Edition</th><td>{{this.edition}}</td></tr>
                      <tr><th>ISBN</th><td>{{this.isbn}}</td></tr>
                    </tbody>
                  </table>
                </td></tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>

  {{/unless}}
</script>

<script type="text/template" id="profile-template">
  {{#if info.found}}
    {{#if edit_mode}}
      <div class="row">
        <div class="col-md-3">
          <img {{#if avatar}}src='{{info.avatar}}'{{else}}src="/default_profile.jpg"{{/if}} width="215"/>
        </div>
        <div class="col-md-9">
          {{#if info.student}}
            <fieldset>
              <legend>Edit Profile Info</legend>
              <div class="field">
                <input type="text" class="form-control" value="{{info.name}}" placeholder="Name" id="name"/>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.email}}" id="email" disabled/>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.department}}" id="department" disabled/>
              </div>
              <div class="field">
                <input type="tel" class="form-control" value="{{info.phone}}" placeholder="Phone" id="phone"/>
              </div>
              <div class="field">
                <a class="btn btn-default btn-success" id="save" href="javascript:history.back()">Save</a>
              </div>
            </fieldset>
          {{else}}
            <fieldset>
              <legend>Edit Profile Info</legend>
              <div class="field">
                <select type="text" class="selectpicker show-tick show-menu-arrow" title="Select Prefix" data-header="Select Prefix" id="prefix"/>
                  {{#each prefix}}
                    <option value={{@key}} {{#if this}}selected{{/if}}>{{@key}}</option>
                  {{/each}}
                </select>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.name}}" placeholder="Name" id="name"/>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.email}}" id="email" disabled/>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.department}}" id="department" disabled/>
              </div>
              <div class="field">
                <input type="tel" class="form-control" value="{{info.phone}}" placeholder="Phone" id="phone"/>
              </div>
              <div class="field">
                <input type="text" class="form-control" value="{{info.Designation}}" placeholder="Designation" id="designation"/>
              </div>
              <div class="field">
                <textarea class="form-control" placeholder="About You" id="about">{{{info.about}}}</textare>
              </div>
              <div class="field">
                <a class="btn btn-default btn-success" id="save" href="javascript:history.back()">Save</a>
              </div>

            </fieldset>
          {{/if}}
          <br/>
          <br/>
          <fieldset>
            <legend>Settings</legend>
            <div class="field">
              Send Email Notifications : 
              <div class="make-switch" data-on="success" data-off="warning">
                <input type="checkbox" checked="checked" disabled/>
              </div>
            </div>
            <div class="field">
              Send SMS Notifications :
              <div class="make-switch" data-on="success" data-off="warning">
                <input type="checkbox" disabled/>
              </div>
            </div>
          </fieldset>
        </div>
      </div>
    {{else}}
      {{#if info.edit}}
        <div class="row">
          <div class="pull-right field"><a href="/profile/{{info.email}}/edit" class="btn btn-default btn-primary" id="edit">Edit</a></div>  
        </div>
      {{/if}}
      <div class="row">
        <div class="col-md-3">
          <img {{#if avatar}}src='{{info.avatar}}'{{else}}src="/default_profile.jpg"{{/if}} width="215"/>
        </div>
        <div class="col-md-9">
          <table class="table table-striped">
            <tbody>
              {{#if info.student}}
                <tr>
                  <th>Name</th>
                  <td>{{info.name}}</td>
                </tr>
                <tr>
                  <th>Department</th>
                  <td>{{info.department}}({{info.department_short}})</td>
                </tr>
                <tr>
                  <th>Email</th>
                  <td>{{info.email}}@nitt.edu</td>
                </tr>
                <tr>
                  <th>Status</th>
                  <td>Student</td>
                </tr>
                <tr>
                  <th>Courses Subscribed</th>
                  <td></td>
                </tr>
                <tr>
                  <th>Courses Attended/Attending</th>
                  <td></td>
                </tr>
              {{else}}
                <tr>
                  <th>Name</th>
                  <td>{{info.prefix}} {{info.name}}</td>
                </tr>
                <tr>
                  <th>Department</th>
                  <td>{{info.department}}({{info.department_short}})</td>
                </tr>
                <tr>
                  <th>Email</th>
                  <td>{{info.email}}@nitt.edu</td>
                </tr>
                <tr>
                  <th>Status</th>
                  <td>Faculty</td>
                </tr>
                <tr>
                  <th>Designation</th>
                  <td>{{info.designation}}</td>
                </tr>
                <tr>
                  <th>About</th>
                  <td>{{{info.about}}}</td>
                </tr>
                <tr>
                  <th>Courses Handeled/Handling</th>
                  <td></td>
                </tr>
              {{/if}}
            </tbody>
          </table>
        </div>
      </div>
    {{/if}}
  {{else}}
    <div>User not found</div>
  {{/if}}
</script>

<script type="text/template" id="404-template">
  <h3 style="font-size: 60px; margin: 30px; ">Its a 404!</h3>
  <p class="lead">This means, the page you&#39;re trying to access does not exist!</p>
  <div>
    <a href="javascript:history.back()" class="btn btn-default">
      <i class="glyphicon glyphicon-chevron-left"></i> Back
    </a>
    <a href="/" class="btn btn-default">
      <i class="glyphicon glyphicon-home"></i> Home
    </a>
  </div>
</script>

